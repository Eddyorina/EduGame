<!DOCTYPE html>
<html>
<head>
<title>LoginPage</title>
<meta charset="utf-8">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
<script src="jquery-3.3.1.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
<script src="jquery-validation-1.17.0/dist/jquery.validate.js"></script>
<script type="text/javascript">

  $(document).ready(() => {
    
    $(".submit").on("click", () => {
      var _email = $("#email").val();
      var _password = $("#pass").val();

      $.post("server/login.php",
        {email: _email, password: _password},
        (data, textStatus, jqXHR) => {
          if(data["error"]){
            console.log("Error present");
            console.log(data["error_message"]);
            $(".error-message").text(data["error_message"]);
          }
          else{
            if(data["user"]["type"] == "privileged"){
              console.log("very privileged");
              localStorage.setItem("privilege", "privileged");
            } else {
              console.log("not privileged");
              localStorage.setItem("privilege", "normal");
            }
            console.log("No error present");
            localStorage.setItem("userid", data["user"]["userID"]);
            localStorage.setItem("useremail", data["user"]["useremail"]);
            localStorage.setItem("firstname", data["user"]["firstname"]);
            localStorage.setItem("lastname", data["user"]["lastname"]);
            console.log($("#lastname-text").val());
            if(data["user"]["type"] == "privileged"){
              window.location.href = "admin-page.html";  
            } else {
              window.location.href = "catalog.html";
            }
          }
        }, "json");
    });

  });


</script>
<link rel="stylesheet" type="text/css" href="home.css">
</head>
<body>
<nav class="navbar navbar-dark bg-dark navbar-expand-lg justify-content-center">
    <a class="navbar-brand heading" href="#">EduGame</a>
  </nav>
  <div class="container text-center my-4 h1 text-dark">Have fun learning!</div>
  <div class="container text-center mt-3 h3 text-secondary">Sign Up</div>

<div class="login">
    <!-- <img src="Media/avatar.jpg" alt="Avatar" class="avatar"> -->
    <h1>Login</h1>
      <span>Email</span>
      <input type="text" id="email" name="email" placeholder="Enter email">
      <br><br>
      <span>Password</span>
      <input type="password" id="pass" name="password" placeholder="Enter Password">
      <br><br>
      <button class="submit">Login</button>
      <center><a href="#">Forgot Password?</a><br><a href="signup.html">Create Account</a></center>
      <br><br>
      <center><div class="error-message"></div></center>
</div>
</body>
</html>
